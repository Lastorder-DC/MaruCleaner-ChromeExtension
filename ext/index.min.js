var dom={url:location,urlBase:location.pathname.split("/"),src:[],img:[],season:[],nowView:1,addSrc:function(e){this.src.push(e)},addImg:function(e){this.img.push(e)},make:{img:function(){for(i=0;i<dom.img.length;i++)$("body").append("<img src='"+dom.url.origin+dom.img[i]+"' count='"+i+"' class='view'>")},header:function(){$("body").append("<div class='view-header'><div class='left header-list bbtn hand'>목록</div><div class='left header-title'><span class='small'>"+dom.now+"개 <</span> "+dom.name.base+" <span class='small'>> "+(dom.season.length-dom.now-1)+"개</span></div></div>"),$("div.view-header").prepend(dom.urlBase[2]==dom.season[0][1]?"<div class='bbtn btn-lock'>이전</div>":"<a href='"+dom.season[dom.now-1][1]+"'><div class='bbtn bdr0 only-line'>이전("+dom.season[dom.now-1][0]+")</div></a>"),$("div.view-header").append(dom.urlBase[2]==dom.season[dom.season.length-1][1]?"<div class='bbtn btn-lock'>다음</div>":"<a href='"+dom.season[dom.now+1][1]+"'><div class='bbtn bdr0 only-line'>다음("+dom.season[dom.now+1][0]+")</div></a>")},nowPage:function(){$("body").append("<div class='view-page'><span class='now'>"+dom.nowView+"</span>/"+dom.img.length+"</span></div>")},lockBox:function(){$("body").append("<div class='wac5 box lock-box mt-p10 p10'><div class='b3'>이 페이지는 잠겨 있습니다.</div></div>"),$("div.lock-box").append("<form action='"+location.href+"' class='wac8 b4 mt20' method='POST'><input type='password' name='pass' placeholder='비밀번호 입력' class='w12'><button class='btn oran w12 mt10'>확인</form>")},listBox:function(){$("div.view-header").append("<div class='list-box b5 w12 hide'></div>"),$.each(dom.season,function(e,o){color=-1==dom.sync.dataView.indexOf(o[1])?"tblue":"tgrey",0!=e&&$(".list-box").append("<span class='l p10'> | </span>"),$(".list-box").append("<a href='http://wasabisyrup.com/archives/"+o[1]+"'><span class='"+color+" p10'>"+o[0]+"</span></a>")})}},now:{},name:{base:$("title").html(),title:function(){if(arr=this.base.split(" "),name="",arr.length<1)return base;for(i=0;i<arr.length-1;i++)0!=i&&(name+=" "),name+=arr[i];return name}},sync:{data:[],dataView:[],save:{json:""},view:{view:""}},lock:!1};document.onreadystatechange=function(e){if("interactive"==document.readyState){for(i=0;i<e.srcElement.all.length;i++){var o=e.srcElement.all[i];"script"==o.localName?dom.addSrc(o):"img"==o.localName&&dom.addImg(o.attributes[2].value)}!function(){var e=!1;$.each($("select.list-articles > option"),function(o,a){return s=$(a).html().replace(/([\s|\n|\t|\r])+/gi,""),void 0!=dom.season[0]&&dom.season[0][1]==$(a).val()?(e=!0,!1):($(a).val()==dom.urlBase[2]&&(dom.now=dom.season.length),void dom.season.push([$(a).html().replace(/	/g,""),$(a).val()]))})}(),dom.lock=0!=$("form").length?!0:!1,dom.name.base=$("div.article-title").attr("title"),root.remove(),$("head").remove()}"complete"==document.readyState&&(1==dom.lock&&0==dom.img.length?dom.make.lockBox():dom.make.img(),dom.make.header(),dom.make.nowPage(),$(function(){var e=0;$(window).scroll(function(){var o=$(this).scrollTop();o>e?(now=$(document).scrollTop()+$(window).height(),max=$(document).height(),now==max?($("div.view-header").removeClass("bye"),$("span.now").html(dom.img.length)):$("div.view-header").addClass("bye")):$("div.view-header").removeClass("bye"),$.each($("img.view"),function(e,o){return $(o).offset().top-$(window).height()/3>$(window).scrollTop()?($("span.now").html($(o).attr("count")),!1):void 0}),e=o})}),$(document).on("click",".header-list",function(){$(".list-box").toggleClass("hide")}),chrome.storage.sync.get(dom.sync.save,function(e){""==e.json?e={json:"[]"}:dom.sync.data=JSON.parse(e.json),dom.sync.data.length>30&&(dom.sync.data=dom.sync.data.slice(1)),save=dom.sync.data;var o=-1;save.forEach(function(e,a){e.name==dom.name.title()&&(o=a)}),-1==o&&(o=save.length),reg=dom.season[dom.now][0].search(/[0-9]/i),-1!=reg&&(save[o]={name:dom.name.title(),size:dom.season.length,link:dom.season[dom.now]}),dom.sync.save.json=JSON.stringify(save),chrome.storage.sync.set(dom.sync.save,function(){})}),chrome.storage.sync.get(dom.sync.view,function(e){""==e.view&&(e={view:"[]"}),dom.sync.dataView=JSON.parse(e.view),isset=dom.sync.dataView.indexOf(dom.season[dom.now][1]),-1==isset&&(dom.sync.dataView[dom.sync.dataView.length]=dom.season[dom.now][1],dom.sync.view.view=JSON.stringify(dom.sync.dataView),chrome.storage.sync.set(dom.sync.view,function(){})),dom.make.listBox()}))};